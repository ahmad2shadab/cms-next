<aside id="sidebar" class="fixed left-0 top-16 lg:top-20 z-40 h-[calc(100vh-9rem)] w-64 -translate-x-full transform border-r bg-background transition-transform duration-300 ease-in-out lg:translate-x-0">
    <div class="flex h-full flex-col overflow-y-auto">
        <div class="border-b p-6">
            <div class="flex items-center space-x-3">
                <div class="flex h-10 w-10 items-center justify-center rounded-full bg-primary text-primary-foreground">
                    <i class="fas fa-user"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-foreground truncate">Admin</p>
                    <p class="text-xs text-muted-foreground truncate">Administrator</p>
                </div>
                <button class="lg:hidden p-1 rounded-md hover:bg-accent" onclick="closeSidebar()">
                    <i class="fas fa-times h-4 w-4"></i>
                </button>
            </div>
        </div>
        
        <nav class="flex-1 space-y-2 p-4">
            <a href="dashboard.html" class="nav-item group flex items-center rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                <i class="fas fa-chart-bar mr-3 h-4 w-4"></i>
                Dashboard
            </a>
            
            <div class="pt-4 space-y-1">
                <h3 class="px-3 text-xs font-semibold uppercase tracking-wider text-muted-foreground">
                    Grievance Management
                </h3>
                <a href="register.html" class="nav-item group flex items-center rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                    <i class="fas fa-plus-circle mr-3 h-4 w-4 text-green-500"></i>
                    New Grievance
                </a>
                <a href="grievance-history.html" class="nav-item group flex items-center rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                    <i class="fas fa-list-ul mr-3 h-4 w-4"></i>
                    Grievance History
                </a>
            </div>

             <div class="pt-4 space-y-1">
                 <h3 class="px-3 text-xs font-semibold uppercase tracking-wider text-muted-foreground">
                    Tracking
                </h3>
                <a href="dashboard.html#pending" class="nav-item group flex items-center justify-between rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                    <div class="flex items-center">
                        <i class="fas fa-clock mr-3 h-4 w-4 text-yellow-500"></i>
                        Pending
                    </div>
                    <span class="inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">12</span>
                </a>
                <a href="dashboard.html#in-process" class="nav-item group flex items-center justify-between rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                    <div class="flex items-center">
                        <i class="fas fa-spinner mr-3 h-4 w-4 text-blue-500"></i>
                        In Process
                    </div>
                    <span class="inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300">5</span>
                </a>
                <a href="dashboard.html#resolved" class="nav-item group flex items-center justify-between rounded-md px-3 py-2 text-sm text-muted-foreground font-medium transition-colors hover:bg-accent hover:text-accent-foreground">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle mr-3 h-4 w-4 text-green-500"></i>
                        Resolved
                    </div>
                    <span class="inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800 dark:bg-green-900 dark:text-green-300">28</span>
                </a>
            </div>
        </nav>
        
        <div class="border-t p-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-r from-green-400 to-blue-500">
                        <div class="h-2 w-2 rounded-full bg-white"></div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-xs text-muted-foreground">System Status</p>
                        <p class="text-xs font-medium text-green-600">Online</p>
                    </div>
                </div>
                <button class="rounded-md p-1 text-muted-foreground hover:bg-accent hover:text-accent-foreground">
                    <i class="fas fa-sign-out-alt h-4 w-4"></i>
                </button>
            </div>
        </div>
    </div>
</aside>

<div id="sidebarOverlay" class="fixed inset-0 z-30 bg-black/50 lg:hidden" style="display: none;" onclick="closeSidebar()"></div>

<script>
// Sidebar functionality
function initializeSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    
    // Update active nav item based on current section
    updateActiveNavItem();
}

function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar && overlay) {
        const isOpen = !sidebar.classList.contains('-translate-x-full');
        
        if (isOpen) {
            closeSidebar();
        } else {
            openSidebar();
        }
    }
}

function openSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar && overlay) {
        sidebar.classList.remove('-translate-x-full');
        overlay.style.display = 'block';
        document.body.classList.add('overflow-hidden');
    }
}

function closeSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar && overlay) {
        sidebar.classList.add('-translate-x-full');
        overlay.style.display = 'none';
        document.body.classList.remove('overflow-hidden');
    }
}

/**
 * MODIFIED: Implemented the logic to highlight the active navigation link.
 */
function updateActiveNavItem() {
    const currentPath = window.location.pathname.split('/').pop();
    const navLinks = document.querySelectorAll('#sidebar .nav-item');

    navLinks.forEach(link => {
        const linkPath = link.getAttribute('href').split('/').pop();
        
        // Remove any existing active classes
        link.classList.remove('bg-accent', 'text-accent-foreground');
        link.querySelector('i')?.classList.remove('text-accent-foreground');

        // Check for a match
        // Handles the case where the root path should default to the dashboard
        if ((currentPath === '' || currentPath === 'index.html' || currentPath === 'dashboard.html') && linkPath.includes('dashboard.html')) {
             link.classList.add('bg-accent', 'text-accent-foreground');
             link.querySelector('i')?.classList.add('text-accent-foreground');
        } else if (currentPath !== '' && linkPath !== '' && currentPath.includes(linkPath)) {
             link.classList.add('bg-accent', 'text-accent-foreground');
             link.querySelector('i')?.classList.add('text-accent-foreground');
        }
    });
}

// Handle mobile menu toggle
document.addEventListener('DOMContentLoaded', function() {
    // This logic should be in your main script.js, but is included here for completeness
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    if (mobileMenuToggle) {
        mobileMenuToggle.addEventListener('click', toggleSidebar);
    }
    
    // Initialize the sidebar state on page load
    initializeSidebar();
    
    // Close sidebar on window resize if switching to desktop view
    window.addEventListener('resize', function() {
        if (window.innerWidth >= 1024) {
            closeSidebar();
        }
    });
});
</script>