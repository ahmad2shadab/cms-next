<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grievance History - e-Nivaran</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              border: 'hsl(214.3 31.8% 91.4%)',
              input: 'hsl(214.3 31.8% 91.4%)',
              ring: 'hsl(222.2 84% 4.9%)',
              background: 'hsl(0 0% 100%)',
              foreground: 'hsl(222.2 84% 4.9%)',
              primary: {
                DEFAULT: 'hsl(222.2 47.4% 11.2%)',
                foreground: 'hsl(210 40% 98%)',
              },
              secondary: {
                DEFAULT: 'hsl(210 40% 96%)',
                foreground: 'hsl(222.2 84% 4.9%)',
              },
              destructive: {
                DEFAULT: 'hsl(0 84.2% 60.2%)',
                foreground: 'hsl(210 40% 98%)',
              },
              muted: {
                DEFAULT: 'hsl(210 40% 96%)',
                foreground: 'hsl(215.4 16.3% 46.9%)',
              },
              accent: {
                DEFAULT: 'hsl(210 40% 96%)',
                foreground: 'hsl(222.2 84% 4.9%)',
              },
              popover: {
                DEFAULT: 'hsl(0 0% 100%)',
                foreground: 'hsl(222.2 84% 4.9%)',
              },
              card: {
                DEFAULT: 'hsl(0 0% 100%)',
                foreground: 'hsl(222.2 84% 4.9%)',
              },
            },
            borderRadius: {
              lg: 'var(--radius)',
              md: 'calc(var(--radius) - 2px)',
              sm: 'calc(var(--radius) - 4px)',
            },
          },
        },
        darkMode: 'class',
      };
    </script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body class="min-h-screen bg-background font-sans antialiased">
    <!-- Header -->
    <div id="header-container"></div>

    <!-- Main Layout -->
    <div class="flex">
      <!-- Sidebar -->
      <div id="sidebar-container"></div>

      <!-- Main Content -->
      <main class="flex-1 lg:ml-64 transition-all duration-300 ease-in-out">
        <div class="p-4 sm:p-6 lg:p-8">
          <!-- Page Header -->
          <div class="mb-6 sm:mb-8">
            <div class="rounded-lg border bg-card p-4 sm:p-6 shadow-sm">
              <div
                class="flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-3 sm:space-y-0"
              >
                <div
                  class="flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 text-white"
                >
                  <i class="fas fa-history text-lg sm:text-xl"></i>
                </div>
                <div>
                  <h1
                    class="text-2xl sm:text-3xl font-bold text-card-foreground"
                  >
                    Grievance History
                  </h1>
                  <p class="text-sm sm:text-base text-muted-foreground">
                    Track and view all your submitted grievances
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Grievance History Table -->
          <div class="rounded-lg border bg-card shadow-sm overflow-hidden">
            <!-- Table Header -->
            <div
              class="bg-gradient-to-r from-blue-500 to-blue-600 px-4 sm:px-6 py-3 sm:py-4"
            >
              <div
                class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0"
              >
                <div class="flex items-center space-x-2 sm:space-x-3">
                  <i
                    class="fas fa-list-alt text-white h-4 w-4 sm:h-5 sm:w-5"
                  ></i>
                  <h2 class="text-base sm:text-lg font-semibold text-white">
                    Grievance History
                  </h2>
                </div>
                <div class="flex items-center">
                  <div class="relative w-full sm:w-auto">
                    <input
                      type="search"
                      id="grievanceSearch"
                      placeholder="Search..."
                      class="w-full sm:w-64 rounded-md border border-white/20 bg-white/10 backdrop-blur-sm px-4 py-2 text-sm text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent"
                    />
                    <i
                      class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-white/70 h-4 w-4"
                    ></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- Table Content -->
            <div class="overflow-x-auto">
              <table
                id="grievanceTable"
                class="min-w-full divide-y divide-gray-200"
              >
                <thead class="bg-gray-50">
                  <tr>
                    <th
                      class="px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      <div class="flex items-center space-x-1">
                        <span class="hidden sm:inline">Sl No.</span>
                        <span class="sm:hidden">#</span>
                        <i class="fas fa-sort text-gray-400 h-3 w-3"></i>
                      </div>
                    </th>
                    <th
                      class="px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      <div class="flex items-center space-x-1">
                        <span class="hidden sm:inline">Grievance ID</span>
                        <span class="sm:hidden">ID</span>
                        <i class="fas fa-sort text-gray-400 h-3 w-3"></i>
                      </div>
                    </th>
                    <th
                      class="hidden md:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      <div class="flex items-center space-x-1">
                        <span>Reg Date</span>
                        <i class="fas fa-sort text-gray-400 h-3 w-3"></i>
                      </div>
                    </th>
                    <th
                      class="hidden lg:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      <div class="flex items-center space-x-1">
                        <span>Last Update</span>
                        <i class="fas fa-sort text-gray-400 h-3 w-3"></i>
                      </div>
                    </th>
                    <th
                      class="px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Status
                    </th>
                    <th
                      class="px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Action
                    </th>
                  </tr>
                </thead>
                <tbody
                  id="grievanceTableBody"
                  class="bg-white divide-y divide-gray-200"
                >
                  <!-- Empty state -->
                  <tr id="emptyState">
                    <td
                      colspan="6"
                      class="px-4 sm:px-6 py-8 sm:py-12 text-center"
                    >
                      <div
                        class="flex flex-col items-center justify-center space-y-3 sm:space-y-4"
                      >
                        <div
                          class="flex h-12 w-12 sm:h-16 sm:w-16 items-center justify-center rounded-full bg-gray-100"
                        >
                          <i
                            class="fas fa-inbox text-xl sm:text-2xl text-gray-400"
                          ></i>
                        </div>
                        <div>
                          <h3 class="text-sm font-medium text-gray-900">
                            No data available in table
                          </h3>
                          <p class="text-xs sm:text-sm text-gray-500 mt-1">
                            No grievances found matching your criteria
                          </p>
                        </div>
                        <button
                          onclick="loadSampleData()"
                          class="mt-2 inline-flex items-center px-4 py-2 text-sm font-medium text-primary-foreground bg-primary rounded-md hover:bg-primary/90 transition-colors"
                        >
                          <i class="fas fa-plus mr-2 h-4 w-4"></i>
                          Load Sample Data
                        </button>
                      </div>
                    </td>
                  </tr>

                  <!-- Sample data rows (hidden by default) -->
                  <tr
                    class="sample-row hidden hover:bg-gray-50 transition-colors"
                  >
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      1
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <div class="text-sm font-medium text-blue-600">
                        GRV-2025-001
                      </div>
                      <div class="text-xs text-gray-500 md:hidden">
                        Reg: 15/01/2025
                      </div>
                      <div class="text-xs text-gray-500 lg:hidden">
                        Updated: 20/01/2025
                      </div>
                    </td>
                    <td
                      class="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      15/01/2025
                    </td>
                    <td
                      class="hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      20/01/2025
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <span
                        class="inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
                      >
                        <i class="fas fa-spinner mr-1 h-3 w-3"></i>
                        <span class="hidden sm:inline">In Progress</span>
                        <span class="sm:hidden">Progress</span>
                      </span>
                    </td>
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium"
                    >
                      <div class="flex items-center space-x-2">
                        <button
                          class="text-blue-600 hover:text-blue-900 transition-colors"
                          onclick="viewGrievance('GRV-2025-001')"
                        >
                          <i class="fas fa-eye h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">View</span>
                        </button>
                        <button
                          class="text-green-600 hover:text-green-900 transition-colors"
                          onclick="trackGrievance('GRV-2025-001')"
                        >
                          <i class="fas fa-map-marker-alt h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">Track</span>
                        </button>
                      </div>
                    </td>
                  </tr>

                  <tr
                    class="sample-row hidden hover:bg-gray-50 transition-colors"
                  >
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      2
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <div class="text-sm font-medium text-blue-600">
                        GRV-2025-002
                      </div>
                      <div class="text-xs text-gray-500 md:hidden">
                        Reg: 10/01/2025
                      </div>
                      <div class="text-xs text-gray-500 lg:hidden">
                        Updated: 25/01/2025
                      </div>
                    </td>
                    <td
                      class="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      10/01/2025
                    </td>
                    <td
                      class="hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      25/01/2025
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <span
                        class="inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
                      >
                        <i class="fas fa-check-circle mr-1 h-3 w-3"></i>
                        <span class="hidden sm:inline">Resolved</span>
                        <span class="sm:hidden">Done</span>
                      </span>
                    </td>
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium"
                    >
                      <div class="flex items-center space-x-2">
                        <button
                          class="text-blue-600 hover:text-blue-900 transition-colors"
                          onclick="viewGrievance('GRV-2025-002')"
                        >
                          <i class="fas fa-eye h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">View</span>
                        </button>
                        <button
                          class="text-green-600 hover:text-green-900 transition-colors"
                          onclick="trackGrievance('GRV-2025-002')"
                        >
                          <i class="fas fa-map-marker-alt h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">Track</span>
                        </button>
                      </div>
                    </td>
                  </tr>

                  <tr
                    class="sample-row hidden hover:bg-gray-50 transition-colors"
                  >
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      3
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <div class="text-sm font-medium text-blue-600">
                        GRV-2025-003
                      </div>
                      <div class="text-xs text-gray-500 md:hidden">
                        Reg: 05/01/2025
                      </div>
                      <div class="text-xs text-gray-500 lg:hidden">
                        Updated: 08/01/2025
                      </div>
                    </td>
                    <td
                      class="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      05/01/2025
                    </td>
                    <td
                      class="hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      08/01/2025
                    </td>
                    <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                      <span
                        class="inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"
                      >
                        <i class="fas fa-clock mr-1 h-3 w-3"></i>
                        <span class="hidden sm:inline">Pending</span>
                        <span class="sm:hidden">Wait</span>
                      </span>
                    </td>
                    <td
                      class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium"
                    >
                      <div class="flex items-center space-x-2">
                        <button
                          class="text-blue-600 hover:text-blue-900 transition-colors"
                          onclick="viewGrievance('GRV-2025-003')"
                        >
                          <i class="fas fa-eye h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">View</span>
                        </button>
                        <button
                          class="text-green-600 hover:text-green-900 transition-colors"
                          onclick="trackGrievance('GRV-2025-003')"
                        >
                          <i class="fas fa-map-marker-alt h-4 w-4"></i>
                          <span class="hidden sm:inline ml-1">Track</span>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Table Footer -->
            <div class="bg-gray-50 px-4 sm:px-6 py-3 border-t border-gray-200">
              <div
                class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0"
              >
                <div class="text-xs sm:text-sm text-gray-700">
                  <span id="tableInfo">Showing 0 to 0 of 0 entries</span>
                </div>
                <div
                  class="flex items-center justify-center sm:justify-end space-x-1 sm:space-x-2"
                >
                  <button
                    id="prevBtn"
                    class="px-2 sm:px-3 py-1 text-xs sm:text-sm bg-white border border-gray-300 rounded-l-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                    disabled
                  >
                    <i class="fas fa-angle-double-left"></i>
                  </button>
                  <button
                    id="prevPageBtn"
                    class="px-2 sm:px-3 py-1 text-xs sm:text-sm bg-white border-t border-b border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                    disabled
                  >
                    <i class="fas fa-angle-left"></i>
                  </button>
                  <span
                    id="pageInfo"
                    class="px-2 sm:px-3 py-1 text-xs sm:text-sm bg-blue-500 text-white border border-blue-500"
                    >1</span
                  >
                  <button
                    id="nextPageBtn"
                    class="px-2 sm:px-3 py-1 text-xs sm:text-sm bg-white border-t border-b border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                    disabled
                  >
                    <i class="fas fa-angle-right"></i>
                  </button>
                  <button
                    id="nextBtn"
                    class="px-2 sm:px-3 py-1 text-xs sm:text-sm bg-white border border-gray-300 rounded-r-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                    disabled
                  >
                    <i class="fas fa-angle-double-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div
            class="mt-4 sm:mt-6 flex flex-col gap-3 sm:gap-4 sm:flex-row sm:justify-between"
          >
            <button
              type="button"
              onclick="window.history.back();"
              class="inline-flex items-center justify-center rounded-md border border-input bg-background px-6 sm:px-8 py-2 text-sm font-medium text-foreground shadow-sm transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"
            >
              <i class="fas fa-arrow-left mr-2 h-4 w-4"></i>
              <span class="hidden sm:inline">Back to Dashboard</span>
              <span class="sm:hidden">Back</span>
            </button>

            <button
              onclick="navigateToSection('register')"
              class="inline-flex items-center justify-center rounded-md bg-primary px-6 sm:px-8 py-2 text-sm font-medium text-primary-foreground shadow transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"
            >
              <i class="fas fa-plus-circle mr-2 h-4 w-4"></i>
              <span class="hidden sm:inline">Register New Grievance</span>
              <span class="sm:hidden">New Grievance</span>
            </button>
          </div>
        </div>
      </main>
    </div>

    <!-- Footer -->
    <div id="footer-container" class="lg:ml-64"></div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Load components
        loadComponent('header.html', 'header-container');
        loadComponent('sidebar.html', 'sidebar-container');
        loadComponent('footer.html', 'footer-container');
      
        // Initialize grievance history
        initializeGrievanceHistory();
      });
      
      function loadComponent(file, containerId) {
        fetch(file)
          .then((response) => response.text())
          .then((data) => {
            document.getElementById(containerId).innerHTML = data;
            if (file === 'header.html') initializeHeader();
            if (file === 'sidebar.html') initializeSidebar();
          })
          .catch((error) => console.error('Error loading component:', error));
      }
      
      function initializeGrievanceHistory() {
        // Sample data - replace with actual API call
        const sampleData = [];
      
        // Initialize search functionality
        const searchInput = document.getElementById('grievanceSearch');
        searchInput.addEventListener('input', function () {
          filterGrievances(this.value);
        });
      
        // Load data
        loadGrievanceData(sampleData);
      
        // Modal event listeners
        setupModalEventListeners();
      }
      
      function setupModalEventListeners() {
        // Close modals on backdrop click
        document.getElementById('viewModal').addEventListener('click', function(e) {
          if (e.target === this) closeViewModal();
        });
        
        document.getElementById('trackModal').addEventListener('click', function(e) {
          if (e.target === this) closeTrackModal();
        });
      
        // Close modals on Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            closeViewModal();
            closeTrackModal();
          }
        });
      }
      
      function loadSampleData() {
        const sampleRows = document.querySelectorAll('.sample-row');
        const emptyState = document.getElementById('emptyState');
      
        emptyState.style.display = 'none';
        sampleRows.forEach((row) => row.classList.remove('hidden'));
      
        // Update table info
        document.getElementById('tableInfo').textContent = 'Showing 1 to 3 of 3 entries';
      }

      // Update table info dynamically
const visibleRows = document.querySelectorAll('.sample-row:not([style*="display: none"])').length;
document.getElementById('tableInfo').textContent = `Showing 1 to ${visibleRows} of ${visibleRows} entries`;

      
      function loadGrievanceData(data) {
        const tbody = document.getElementById('grievanceTableBody');
        const emptyState = document.getElementById('emptyState');
        const tableInfo = document.getElementById('tableInfo');
      
        if (data.length === 0) {
          emptyState.style.display = 'table-row';
          tableInfo.textContent = 'Showing 0 to 0 of 0 entries';
          return;
        }
      
        emptyState.style.display = 'none';
      
        // Clear existing rows except empty state and sample rows
        const existingRows = tbody.querySelectorAll('tr:not(#emptyState):not(.sample-row)');
        existingRows.forEach((row) => row.remove());
      
        // Add data rows
        data.forEach((item, index) => {
          const row = createGrievanceRow(item, index + 1);
          tbody.appendChild(row);
        });
      
        // Update table info
        tableInfo.textContent = `Showing 1 to ${data.length} of ${data.length} entries`;
      }
      
      function createGrievanceRow(item, slNo) {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
      
        const statusColor = getStatusColor(item.status);
      
        row.innerHTML = `
          <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900">${slNo}</td>
          <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-blue-600">${item.grievanceId}</div>
              <div class="text-xs text-gray-500 md:hidden">Reg: ${formatDate(item.regDate)}</div>
              <div class="text-xs text-gray-500 lg:hidden">Updated: ${formatDate(item.lastUpdate)}</div>
          </td>
          <td class="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(item.regDate)}</td>
          <td class="hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(item.lastUpdate)}</td>
          <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
              <span class="inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                  ${getStatusIcon(item.status)}
                  <span class="hidden sm:inline">${item.status}</span>
                  <span class="sm:hidden">${getStatusShort(item.status)}</span>
              </span>
          </td>
          <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium">
              <div class="flex items-center space-x-2">
                  <button class="text-blue-600 hover:text-blue-900 transition-colors" onclick="viewGrievance('${item.grievanceId}')">
                      <i class="fas fa-eye h-4 w-4"></i>
                      <span class="hidden sm:inline ml-1">View</span>
                  </button>
                  <button class="text-green-600 hover:text-green-900 transition-colors" onclick="trackGrievance('${item.grievanceId}')">
                      <i class="fas fa-map-marker-alt h-4 w-4"></i>
                      <span class="hidden sm:inline ml-1">Track</span>
                  </button>
              </div>
          </td>
        `;
      
        return row;
      }
      
      // SEARCH FUNCTIONALITY
function filterGrievances(searchTerm) {
  const tbody = document.getElementById('grievanceTableBody');
  const rows = tbody.querySelectorAll('tr:not(#emptyState)');
  const emptyState = document.getElementById('emptyState');
  const searchLower = searchTerm.toLowerCase().trim();
  
  let visibleCount = 0;

  rows.forEach(row => {
    if (searchLower === '') {
      row.style.display = '';
      if (!row.classList.contains('hidden')) visibleCount++;
      return;
    }

    const cells = row.querySelectorAll('td');
    let rowText = '';
    
    // Extract text from relevant columns (ID, dates, status)
    cells.forEach((cell, index) => {
      if (index === 1 || index === 2 || index === 3 || index === 4) { // ID, dates, status columns
        rowText += cell.textContent.toLowerCase() + ' ';
      }
    });

    if (rowText.includes(searchLower)) {
      row.style.display = '';
      if (!row.classList.contains('hidden')) visibleCount++;
    } else {
      row.style.display = 'none';
    }
  });

  // Update table info dynamically
  if (visibleCount > 0) {
    document.getElementById('tableInfo').textContent = `Showing 1 to ${visibleCount} of ${visibleCount} entries`;
  }

  // Show/hide empty state based on visible results
  if (visibleCount === 0) {
    emptyState.style.display = 'table-row';
    emptyState.querySelector('h3').textContent = searchTerm ? 'No matching results found' : 'No data available in table';
    emptyState.querySelector('p').textContent = searchTerm ? `No grievances match "${searchTerm}"` : 'No grievances found matching your criteria';
    document.getElementById('tableInfo').textContent = 'Showing 0 to 0 of 0 entries';
  } else {
    emptyState.style.display = 'none';
  }
}

      
      // VIEW GRIEVANCE FUNCTIONALITY
      function viewGrievance(grievanceId) {
        const tbody = document.getElementById('grievanceTableBody');
        const rows = tbody.querySelectorAll('tr:not(#emptyState)');
        
        // Find the row with matching grievance ID
        let grievanceData = null;
        rows.forEach(row => {
          const idCell = row.querySelector('td:nth-child(2) div');
          if (idCell && idCell.textContent.trim() === grievanceId) {
            const cells = row.querySelectorAll('td');
            const statusSpan = cells[4].querySelector('span');
            
            grievanceData = {
              id: grievanceId,
              regDate: cells[2] ? cells[2].textContent.trim() : cells[1].querySelector('.text-xs:first-of-type')?.textContent.replace('Reg: ', '') || 'N/A',
              lastUpdate: cells[3] ? cells[3].textContent.trim() : cells[1].querySelector('.text-xs:last-of-type')?.textContent.replace('Updated: ', '') || 'N/A',
              status: statusSpan.querySelector('.hidden')?.textContent || statusSpan.querySelector('.sm\\:hidden')?.textContent || 'Unknown',
              statusClass: statusSpan.className
            };
          }
        });
      
        if (grievanceData) {
          // Populate modal
          document.getElementById('viewGrievanceId').textContent = grievanceData.id;
          document.getElementById('viewRegDate').textContent = grievanceData.regDate;
          document.getElementById('viewLastUpdate').textContent = grievanceData.lastUpdate;
          
          const statusElement = document.getElementById('viewStatus');
          statusElement.textContent = grievanceData.status;
          statusElement.className = grievanceData.statusClass.replace('inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium', 'inline-flex items-center px-2 py-1 rounded-full text-xs font-medium');
      
          // Show modal
          document.getElementById('viewModal').classList.remove('hidden');
          document.body.classList.add('overflow-hidden');
          
          // Focus management
          setTimeout(() => {
            document.querySelector('#viewModal button[onclick="closeViewModal()"]').focus();
          }, 100);
        }
      }
      
      function closeViewModal() {
        document.getElementById('viewModal').classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
      }
      
      // TRACK GRIEVANCE FUNCTIONALITY
      function trackGrievance(grievanceId) {
        const tbody = document.getElementById('grievanceTableBody');
        const rows = tbody.querySelectorAll('tr:not(#emptyState)');
        
        // Find the row with matching grievance ID
        let currentStatus = null;
        rows.forEach(row => {
          const idCell = row.querySelector('td:nth-child(2) div');
          if (idCell && idCell.textContent.trim() === grievanceId) {
            const statusSpan = row.querySelector('td:nth-child(5) span');
            currentStatus = (statusSpan.querySelector('.hidden')?.textContent || statusSpan.querySelector('.sm\\:hidden')?.textContent || 'Unknown').toLowerCase();
          }
        });
      
        if (currentStatus) {
          // Populate modal
          document.getElementById('trackGrievanceId').textContent = grievanceId;
          
          // Reset all steps
          resetTrackingSteps();
          
          // Highlight progress based on current status
          updateTrackingProgress(currentStatus);
      
          // Show modal
          document.getElementById('trackModal').classList.remove('hidden');
          document.body.classList.add('overflow-hidden');
          
          // Focus management
          setTimeout(() => {
            document.querySelector('#trackModal button[onclick="closeTrackModal()"]').focus();
          }, 100);
        }
      }
      
      function resetTrackingSteps() {
        // Reset all steps to default state
        ['pendingStep', 'progressStep', 'resolvedStep'].forEach(id => {
          const step = document.getElementById(id);
          step.className = 'w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center';
          step.querySelector('i').className = step.querySelector('i').className.replace('text-yellow-600 text-blue-600 text-green-600', 'text-gray-500');
        });
        
        ['pendingLine', 'progressLine'].forEach(id => {
          document.getElementById(id).className = 'flex-1 h-0.5 bg-gray-300';
        });
      }
      
      function updateTrackingProgress(status) {
        const pendingStep = document.getElementById('pendingStep');
        const progressStep = document.getElementById('progressStep');
        const resolvedStep = document.getElementById('resolvedStep');
        const pendingLine = document.getElementById('pendingLine');
        const progressLine = document.getElementById('progressLine');
      
        if (status === 'pending' || status === 'wait') {
          pendingStep.className = 'w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center';
          pendingStep.querySelector('i').className = 'fas fa-clock text-yellow-600 text-sm';
        } else if (status === 'in progress' || status === 'progress') {
          // Pending completed
          pendingStep.className = 'w-8 h-8 rounded-full bg-green-100 flex items-center justify-center';
          pendingStep.querySelector('i').className = 'fas fa-check text-green-600 text-sm';
          pendingLine.className = 'flex-1 h-0.5 bg-green-400';
          
          // In Progress active
          progressStep.className = 'w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center';
          progressStep.querySelector('i').className = 'fas fa-spinner text-blue-600 text-sm';
        } else if (status === 'resolved' || status === 'done') {
          // All completed
          pendingStep.className = 'w-8 h-8 rounded-full bg-green-100 flex items-center justify-center';
          pendingStep.querySelector('i').className = 'fas fa-check text-green-600 text-sm';
          pendingLine.className = 'flex-1 h-0.5 bg-green-400';
          
          progressStep.className = 'w-8 h-8 rounded-full bg-green-100 flex items-center justify-center';
          progressStep.querySelector('i').className = 'fas fa-check text-green-600 text-sm';
          progressLine.className = 'flex-1 h-0.5 bg-green-400';
          
          resolvedStep.className = 'w-8 h-8 rounded-full bg-green-100 flex items-center justify-center';
          resolvedStep.querySelector('i').className = 'fas fa-check-circle text-green-600 text-sm';
        }
      }
      
      function closeTrackModal() {
        document.getElementById('trackModal').classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
      }
      
      // Utility functions (unchanged)
      function getStatusColor(status) {
        switch (status?.toLowerCase()) {
          case 'resolved':
            return 'bg-green-100 text-green-800';
          case 'in progress':
            return 'bg-blue-100 text-blue-800';
          case 'pending':
            return 'bg-yellow-100 text-yellow-800';
          case 'rejected':
            return 'bg-red-100 text-red-800';
          default:
            return 'bg-gray-100 text-gray-800';
        }
      }
      
      function getStatusIcon(status) {
        switch (status?.toLowerCase()) {
          case 'resolved':
            return '<i class="fas fa-check-circle mr-1 h-3 w-3"></i>';
          case 'in progress':
            return '<i class="fas fa-spinner mr-1 h-3 w-3"></i>';
          case 'pending':
            return '<i class="fas fa-clock mr-1 h-3 w-3"></i>';
          case 'rejected':
            return '<i class="fas fa-times-circle mr-1 h-3 w-3"></i>';
          default:
            return '<i class="fas fa-question-circle mr-1 h-3 w-3"></i>';
        }
      }
      
      function getStatusShort(status) {
        switch (status?.toLowerCase()) {
          case 'resolved':
            return 'Done';
          case 'in progress':
            return 'Progress';
          case 'pending':
            return 'Wait';
          case 'rejected':
            return 'Reject';
          default:
            return 'Unknown';
        }
      }
      
      function formatDate(dateString) {
        if (!dateString) return 'N/A';
        const date = new Date(dateString);
        return date.toLocaleDateString('en-IN', {
          day: '2-digit',
          month: '2-digit',
          year: 'numeric',
        });
      }
      
      function navigateToSection(section) {
        console.log('Navigate to:', section);
        if (section === 'register') {
          window.location.href = '/register.html';
        } else if (section === 'dashboard') {
          window.location.href = '/dashboard.html';
        }
      }
      </script>
      
    <!-- View Grievance Modal -->
    <div id="viewModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
      <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
          <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10">
                <i class="fas fa-eye text-blue-600"></i>
              </div>
              <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left flex-1">
                <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">Grievance Details</h3>
                <div class="mt-4 space-y-3">
                  <div class="flex justify-between">
                    <span class="text-sm font-medium text-gray-500">Grievance ID:</span>
                    <span id="viewGrievanceId" class="text-sm text-gray-900 font-medium"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-sm font-medium text-gray-500">Registration Date:</span>
                    <span id="viewRegDate" class="text-sm text-gray-900"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-sm font-medium text-gray-500">Last Update:</span>
                    <span id="viewLastUpdate" class="text-sm text-gray-900"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-sm font-medium text-gray-500">Status:</span>
                    <span id="viewStatus" class="text-sm"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
            <button type="button" onclick="closeViewModal()" class="w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Track Grievance Modal -->
    <div id="trackModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="track-modal-title" role="dialog" aria-modal="true">
      <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-md sm:w-full">
          <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10">
                <i class="fas fa-map-marker-alt text-green-600"></i>
              </div>
              <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left flex-1">
                <h3 class="text-lg leading-6 font-medium text-gray-900" id="track-modal-title">Track Grievance</h3>
                <p class="text-sm text-gray-500 mt-1">Grievance ID: <span id="trackGrievanceId" class="font-medium"></span></p>
                <div class="mt-4">
                  <div class="flex items-center space-x-4">
                    <div class="flex flex-col items-center">
                      <div id="pendingStep" class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center">
                        <i class="fas fa-clock text-gray-500 text-sm"></i>
                      </div>
                      <span class="text-xs mt-1 text-gray-500">Pending</span>
                    </div>
                    <div class="flex-1 h-0.5 bg-gray-300" id="pendingLine"></div>
                    <div class="flex flex-col items-center">
                      <div id="progressStep" class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center">
                        <i class="fas fa-spinner text-gray-500 text-sm"></i>
                      </div>
                      <span class="text-xs mt-1 text-gray-500">In Progress</span>
                    </div>
                    <div class="flex-1 h-0.5 bg-gray-300" id="progressLine"></div>
                    <div class="flex flex-col items-center">
                      <div id="resolvedStep" class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center">
                        <i class="fas fa-check-circle text-gray-500 text-sm"></i>
                      </div>
                      <span class="text-xs mt-1 text-gray-500">Resolved</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
            <button type="button" onclick="closeTrackModal()" class="w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    
  </body>
</html>
